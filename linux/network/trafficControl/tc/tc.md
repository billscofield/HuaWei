
## 1. 相关概念

流量控制的一个基本概念是队列(Qdisc)，每个网卡都与一个队列(Qdisc)相联系， 每当内
核需要将报文分组从网卡发送出去， 都会首先将该报文分组添加到该网卡所配置的队列中，
由该队列决定报文分组的发送顺序。因此可以说，所有的流量控制都发生在队列中

有些队列的功能是非常简单的，它们对报文分组实行先来先走的策略。有些队列则功能复
杂，会将不同的报文分组进行排队、分类，并根据不同的原则，以不同的顺序发送队列中
的报文分组。为实现这样的功能，这些复杂的队列需要使用不同的过滤器(Filter)来把报
文分组分成不同的类别(Class)。这里把这些复杂的队列称为可分类(ClassfuI)的队列。


通常， 要实现功能强大的流量控制，可分类的队列是必不可少的。因此，类别(class)和
过滤器(Filter)也是流量控制的另外两个重要的基本概念。

下图所示的是一个可分类队列的例子。

|       +----------+            +-------+--------+
|   --->| 过滤器 1 |----------->| 类别1 | 子队列 |--->
|       +----------+            +-------+--------+
|
|
|
|       +----------+
|   --->| 过滤器 2 |-----+
|       +----------+     |
|                        |      +-------+--------+
|                        +----->| 类别1 | 子队列 |--->
|                        |      +-------+--------+
|       +----------+     |
|   --->| 过滤器 3 |-----+
|       +----------+
|


## 2. 使用TC

在Linux中，流量控制都是通过TC这个工具来完成的。通常，要对网卡进行流量控制的配置，
需要进行如下的步骤：

    1. 为网卡配置一个队列；
    2. 在该队列上建立分类；
    3. 根据需要建立子队列和子分类；
    4. 为每个分类建立过滤器。
